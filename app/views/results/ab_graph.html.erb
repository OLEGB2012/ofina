<%= raw Seer::init_visualization %>

<%  provide(:title, 'Результаты|Графически')%>

<% content_for :span3 do %>      
  <div class="well sidebar-nav">  
    <ul class="nav nav-list">  
      <li class="nav-header">ГРАФИКИ</li>       
      <li><%= link_to "К странице Результаты", results_path(id: @enterprise) %></li>
      <%= render 'ab_graph_anchors'%>      
    </ul>  
  </div>  
<% end  %>

<% content_for :span9 do %>
<a name="BeginOfPage"></a>
<legend><%= image_tag("column chart 64.png") %> Аналитический баланс (Графически)</legend>  
 <table class="table table-striped table-bordered table-condensed">
    <caption style="font-size: 14px">Предприятие - <strong><em><%= @enterprise.org_name %>.</em></strong> 
              За период : <strong><%= Russian::strftime(@enterprise.rab_date_beg,"%d %B %Y г.") %> - 
                                  <%= Russian::strftime(@enterprise.rab_date_end,"%d %B %Y г.") %></strong> </caption>
     <thead>
      <tr>        
        <th><a name="G1"></a> <div class="pagination-centered"  style="font-size: 15px">Динамика статей баланса (в абсолютных значениях)</div></th>
      </tr>
     </thead>
    <tbody>
       <tr>
          <td colspan="3"><div class="pull-left">1. Активы</div></td>
       </tr>  
       <tr>
         <td><div id="Active_abs" ></div></td>
       </tr>
       <tr>
          <td colspan="3"><a name="G2"></a> <div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">2. Пассивы</div></td>
       </tr> 
       <tr>
          <td><div id="Passive_abs"></div></td>
       </tr>       
       <tr>
          <td colspan="3"><a name="G3"></a><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">3. Раздел I. ДОЛГОСРОЧНЫЕ АКТИВЫ</div></td>
       </tr> 
       <tr>
          <td> <div id="Razdel_1_abs"></div></td>
       </tr>
       <tr>
         <td colspan="3"><a name="G4"></a><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">4. Раздел II. КРАТКОСРОЧНЫЕ АКТИВЫ</div></td>
       </tr> 
       <tr>
          <td> <div id="Razdel_2_abs"></div></td>
       </tr>
       <tr>
         <td colspan="3"><a name="G5"></a><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">5. Раздел III. СОБСТВЕННЫЙ КАПИТАЛ</div></td>
       </tr> 
       <tr>
          <td> <div id="Razdel_3_abs"></div></td>
       </tr>
       <tr>
         <td colspan="3"><a name="G6"></a><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">6. Раздел IV. ДОЛГОСРОЧНЫЕ ОБЯЗАТЕЛЬСТВА</div></td>
       </tr> 
       <tr>
          <td> <div id="Razdel_4_abs"></div></td>
       </tr>
       <tr>
         <td colspan="3"><a name="G7"></a><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">7. Раздел V. КРАТКОСРОЧНЫЕ ОБЯЗАТЕЛЬСТВА</div></td>
       </tr> 
       <tr>
          <td> <div id="Razdel_5_abs"></div></td>
       </tr>
       <tr>
         <td colspan="3"><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
    </tbody>   
  </table>

<%#############################################################################################################################%>
<table class="table table-striped table-bordered table-condensed">
     <thead>
      <tr>        
        <th><a name="G8"></a> <div class="pagination-centered"  style="font-size: 15px">Динамика статей баланса (по удельным весам к итогу баланса)</div></th>
      </tr>
     </thead>
    <tbody>
       <tr>
          <td colspan="3"><div class="pull-left">8. Активы</div></td>
       </tr>  
       <tr>
         <td><div id="Active_udel" ></div></td>
       </tr>
       <tr>
          <td colspan="3"><a name="G9"></a> <div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">9. Пассивы</div></td>
       </tr> 
       <tr>
          <td><div id="Passive_udel"></div></td>
       </tr>       
       <tr>
          <td colspan="3"><a name="G10"></a><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">10. Раздел I. ДОЛГОСРОЧНЫЕ АКТИВЫ</div></td>
       </tr> 
       <tr>
          <td> <div id="Razdel_1_udel"></div></td>
       </tr>
       <tr>
         <td colspan="3"><a name="G11"></a><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">11. Раздел II. КРАТКОСРОЧНЫЕ АКТИВЫ</div></td>
       </tr> 
       <tr>
          <td> <div id="Razdel_2_udel"></div></td>
       </tr>
       <tr>
         <td colspan="3"><a name="G12"></a><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">12. Раздел III. СОБСТВЕННЫЙ КАПИТАЛ</div></td>
       </tr> 
       <tr>
          <td> <div id="Razdel_3_udel"></div></td>
       </tr>
       <tr>
         <td colspan="3"><a name="G13"></a><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">13. Раздел IV. ДОЛГОСРОЧНЫЕ ОБЯЗАТЕЛЬСТВА</div></td>
       </tr> 
       <tr>
          <td> <div id="Razdel_4_udel"></div></td>
       </tr>
       <tr>
         <td colspan="3"><a name="G14"></a><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
       <tr>
          <td colspan="3"><div class="pull-left">14. Раздел V. КРАТКОСРОЧНЫЕ ОБЯЗАТЕЛЬСТВА</div></td>
       </tr> 
       <tr>
          <td> <div id="Razdel_5_udel"></div></td>
       </tr>
       <tr>
         <td colspan="3"><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
       </tr>
    </tbody>   
  </table>

<%#############################################################################################################################%>
<table class="table table-bordered table-condensed">
     <thead>
      <tr>        
        <th colspan="3"><a name="G15"></a> <div class="pagination-centered"  style="font-size: 15px">Вертикальный Анализ (по удельным весам статей)</div></th>
      </tr>
     </thead>
    <tbody>
      <% unless @Dates.nil? %>
        <% @Dates.each do |date_line| %>
           <%  @Arr_act << eval("@DiagType_15001_#{date_line.date_period_end.to_s.gsub('-','_')}_data") %>
           <%  @Arr_pas << eval("@DiagType_15002_#{date_line.date_period_end.to_s.gsub('-','_')}_data") %>
           <%  @Arr_act_id << @act_id="Pie_1_"+date_line.date_period_end.to_s.gsub('-','_') %>
           <%  @Arr_pas_id << @pas_id="Pie_2_"+date_line.date_period_end.to_s.gsub('-','_') %>
           <tr>
             <td><div class="pagination-centered" style="line-height: 250px; vertical-align:middle;"><%= Russian::strftime(date_line.date_period_end,"%d %B %Y г.") %></div></td>
             <td><div class='pagination-centered' id="<%=@act_id%>"></div></td>
             <td><div class="pagination-centered" id="<%=@pas_id%>" ></div></td>
           </tr>            
        <% end %> 
      <% end %>     
      <tr>
        <td colspan="3"><div class="pull-left"><%= link_to " (В начало страницы)", "#BeginOfPage"  %></div></td>
      </tr>
    </tbody>   
  </table>

 <% end  %>



 <%#############################################################################################################%>
 <%# Для круговых диаграмм ...%>
<% unless @Arr_act.nil? %>
  <% @Arr_act.each_with_index do |act,acti| %> 
    <%= raw  Seer::visualize(
             act, 
             :as => :pie_chart,
             :in_element => @Arr_act_id[acti],
             :series => {
                  :series_label => 'name',
                  :data_method =>  'summa'
             },
        :chart_options => { 
        :height => 250,
        :width => 250,
        :axis_font_size => 11,
        :title => 'Активы',
        :legend => 'none',
        :tooltip_font_size => 14,
        :colors => ['#800000','#FF0000','#FFA500','#FFFF00',
                    '#808000','#008000','#800080','#FF00FF',
                    '#00FF00','#008080','#FA8072','#0000FF',
                    '#000080','#000000','#808080','#C0C0C0'],
        :point_size => 5,
        :is_3_d => false
      })%>
  <% end %>
<% end %>

<% unless @Arr_pas.nil? %>
  <% @Arr_pas.each_with_index do |pas,pasi| %>
    <%= raw  Seer::visualize(
             pas, 
             :as => :pie_chart,
             :in_element => @Arr_pas_id[pasi],
             :series => {
                  :series_label => 'name',
                  :data_method =>  'summa'
             },
        :chart_options => { 
        :height => 250,
        :width => 250,
        :axis_font_size => 11,
        :title => 'Пассивы',
        :legend => 'none',
        :tooltip_font_size => 14,
        :colors => ['#800000','#FF0000','#FFA500','#FFFF00',
                    '#808000','#008000','#800080','#FF00FF',
                    '#00FF00','#008080','#FA8072','#0000FF',
                    '#000080','#000000','#808080','#C0C0C0',
                    '#9400D3','#FF1493','#4682B4','#F0E68C','#BC8F8F'],                                    
        :point_size => 5,
        :is_3_d => false
      })%>
  <% end %>
<% end %>

<%####################################################################################################################%>
 <%# Диаграммы в абсолютных значениях #%>
  <% unless @DiagType1_data.nil? %>  
    <%= raw Seer::visualize(
      @DiagType1_data, 
      :as => :line_chart,
      :in_element => 'Active_abs',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa',
        :data_series  => @DiagType1_series
      },
      :chart_options => {
        :title_y => 'Сумма, млн.руб.',
        :legend_font_size => 9,
        :height => 300,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#000099','#009900'],
        :point_size => 5})%>
  <% end %>
  
  <% unless @DiagType2_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType2_data, 
      :as => :line_chart,
      :in_element => 'Passive_abs',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa',
        :data_series  => @DiagType2_series
      },
      :chart_options => {
        :title_y => 'Сумма, млн.руб.',
        :legend_font_size => 9,
        :height => 300,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#000099','#009900','#990000'],
        :point_size => 5})%>
  <% end %>
  
  <% unless @DiagType3_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType3_data, 
      :as => :line_chart,
      :in_element => 'Razdel_1_abs',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa',
        :data_series  => @DiagType3_series
      },
      :chart_options => {
        :title_y => 'Сумма, млн.руб.',
        :legend_font_size => 8,
        :height => 400,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#0033FF','#33FF00','#FF0000','#003366','#336600','#660000','#000033','#003300'],
        :point_size => 5})%>
  <% end %>
  
<% unless @DiagType4_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType4_data, 
      :as => :line_chart,
      :in_element => 'Razdel_2_abs',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa',
        :data_series  => @DiagType4_series
      },
      :chart_options => {
        :title_y => 'Сумма, млн.руб.',
        :legend_font_size => 8,
        :height => 400,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#0033FF','#33FF00','#FF0000','#003366','#336600','#660000','#000033','#003300'],
        :point_size => 5})%>
  <% end %>

<% unless @DiagType5_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType5_data, 
      :as => :line_chart,
      :in_element => 'Razdel_3_abs',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa',
        :data_series  => @DiagType5_series
      },
      :chart_options => {
        :title_y => 'Сумма, млн.руб.',
        :legend_font_size => 8,
        :height => 400,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#0033FF','#33FF00','#FF0000','#003366','#336600','#660000','#000033','#003300'],
        :point_size => 5})%>
  <% end %>

<% unless @DiagType6_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType6_data, 
      :as => :line_chart,
      :in_element => 'Razdel_4_abs',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa',
        :data_series  => @DiagType6_series
      },
      :chart_options => {
        :title_y => 'Сумма, млн.руб.',
        :legend_font_size => 9,
        :height => 400,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#0033FF','#33FF00','#FF0000','#003366','#336600','#660000'],
        :point_size => 5})%>
  <% end %>

<% unless @DiagType7_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType7_data, 
      :as => :line_chart,
      :in_element => 'Razdel_5_abs',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa',
        :data_series  => @DiagType7_series
      },
      :chart_options => {
        :title_y => 'Сумма, млн.руб.',
        :legend_font_size => 8,
        :height => 400,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#0033FF','#33FF00','#FF0000','#003366','#336600','#660000','#000033'],
        :point_size => 5})%>
  <% end %>

<%####################################################################################################################%>
 <%# Диаграммы в удельных значениях #%>
  <% unless @DiagType8_data.nil? %>  
    <%= raw Seer::visualize(
      @DiagType8_data, 
      :as => :line_chart,
      :in_element => 'Active_udel',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa_dec',
        :data_series  => @DiagType8_series
      },
      :chart_options => {
        :title_y => 'Удельный вес, %',
        :legend_font_size => 9,
        :height => 300,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#000099','#009900'],
        :point_size => 5})%>
  <% end %>
  
  <% unless @DiagType9_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType9_data, 
      :as => :line_chart,
      :in_element => 'Passive_udel',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa_dec',
        :data_series  => @DiagType9_series
      },
      :chart_options => {
        :title_y => 'Удельный вес, %',
        :legend_font_size => 9,
        :height => 300,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#000099','#009900','#990000'],
        :point_size => 5})%>
  <% end %>
  
  <% unless @DiagType10_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType10_data, 
      :as => :line_chart,
      :in_element => 'Razdel_1_udel',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa_dec',
        :data_series  => @DiagType10_series
      },
      :chart_options => {
        :title_y => 'Удельный вес, %',
        :legend_font_size => 8,
        :height => 400,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#0033FF','#33FF00','#FF0000','#003366','#336600','#660000','#000033','#003300'],
        :point_size => 5})%>
  <% end %>
  
<% unless @DiagType11_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType11_data, 
      :as => :line_chart,
      :in_element => 'Razdel_2_udel',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa_dec',
        :data_series  => @DiagType11_series
      },
      :chart_options => {
        :title_y => 'Удельный вес, %',
        :legend_font_size => 8,
        :height => 400,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#0033FF','#33FF00','#FF0000','#003366','#336600','#660000','#000033','#003300'],
        :point_size => 5})%>
  <% end %>

<% unless @DiagType12_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType12_data, 
      :as => :line_chart,
      :in_element => 'Razdel_3_udel',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa_dec',
        :data_series  => @DiagType12_series
      },
      :chart_options => {
        :title_y => 'Удельный вес, %',
        :legend_font_size => 8,
        :height => 400,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#0033FF','#33FF00','#FF0000','#003366','#336600','#660000','#000033','#003300'],
        :point_size => 5})%>
  <% end %>

<% unless @DiagType13_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType13_data, 
      :as => :line_chart,
      :in_element => 'Razdel_4_udel',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa_dec',
        :data_series  => @DiagType13_series
      },
      :chart_options => {
        :title_y => 'Удельный вес, %',
        :legend_font_size => 9,
        :height => 400,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#0033FF','#33FF00','#FF0000','#003366','#336600','#660000'],
        :point_size => 5})%>
  <% end %>

<% unless @DiagType14_data.nil?%>
    <%= raw Seer::visualize(
      @DiagType14_data, 
      :as => :line_chart,
      :in_element => 'Razdel_5_udel',
      :series => {
        :series_label => 'name',
        :data_label   => 'rus_date_period',
        :data_method  => 'summa_dec',
        :data_series  => @DiagType14_series
      },
      :chart_options => {
        :title_y => 'Удельный вес, %',
        :legend_font_size => 8,
        :height => 400,
        :width => 660,
        :axis_font_size => 11,
        :colors => ['#0033FF','#33FF00','#FF0000','#003366','#336600','#660000','#000033'],
        :point_size => 5})%>
  <% end %>

  <%#= debug(assigns) if Rails.env.development?%>
 
 